[DI] Rework how dagger components are created and provided.
